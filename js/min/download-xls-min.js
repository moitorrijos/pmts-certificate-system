!function($,e,t,n){function a(e,t){this.element=e,this.settings=$.extend({},i,t),this._defaults=i,this._name=l,this.init()}function o(e){return(e.filename?e.filename:"table2excel")+".xls"}var l="table2excel",i={exclude:".noExl",name:"Table2Excel"};a.prototype={init:function(){var e=this;e.template={head:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets>',sheet:{head:"<x:ExcelWorksheet><x:Name>",tail:"</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>"},mid:"</x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body>",table:{head:"<table>",tail:"</table>"},foot:"</body></html>"},e.tableRows=[],$(e.element).each(function(t,n){var a="";$(n).find("tr").not(e.settings.exclude).each(function(e,t){a+="<tr>"+$(t).html()+"</tr>"}),e.tableRows.push(a)}),e.tableToExcel(e.tableRows,e.settings.name)},tableToExcel:function(n,a){var l=this,i="",r,s,c;if(l.uri="data:application/vnd.ms-excel;base64,",l.base64=function(t){return e.btoa(unescape(encodeURIComponent(t)))},l.format=function(e,t){return e.replace(/{(\w+)}/g,function(e,n){return t[n]})},l.ctx={worksheet:a||"Worksheet",table:n},i=l.template.head,$.isArray(n))for(r in n)i+=l.template.sheet.head+"Table"+r+l.template.sheet.tail;if(i+=l.template.mid,$.isArray(n))for(r in n)i+=l.template.table.head+"{table"+r+"}"+l.template.table.tail;i+=l.template.foot;for(r in n)l.ctx["table"+r]=n[r];if(delete l.ctx.table,"undefined"!=typeof msie&&msie>0||navigator.userAgent.match(/Trident.*rv\:11\./))if("undefined"!=typeof Blob){i=[i];var m=new Blob(i,{type:"text/html"});e.navigator.msSaveBlob(m,o(l.settings))}else txtArea1.document.open("text/html","replace"),txtArea1.document.write(l.format(i,l.ctx)),txtArea1.document.close(),txtArea1.focus(),sa=txtArea1.document.execCommand("SaveAs",!0,o(l.settings));else s=l.uri+l.base64(l.format(i,l.ctx)),c=t.createElement("a"),c.download=o(l.settings),c.href=s,t.body.appendChild(c),c.click(),t.body.removeChild(c);return!0}},$.fn[l]=function(e){var t=this;return t.each(function(){$.data(t,"plugin_"+l)||$.data(t,"plugin_"+l,new a(this,e))}),t}}(jQuery,window,document),function($){$(function(){var e=$(".download-xls-button"),t=$(".download-xls-table"),n=$(".print-button");e.click(function(e){e.preventDefault();var n=new Date,a=n.getDate().toString()+"-"+n.getMonth().toString()+"-"+n.getFullYear().toString()+"-"+n.getMilliseconds().toString();t.table2excel({name:"Certificates Table",filename:"panama-certs-"+a})}),n.on("click",function(){window.print()})})}(jQuery);